<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Song Extractor Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <h1>Spotify Song Extractor Dashboard</h1>
    
    <button id="startProcess">Start Process</button>
    
    <h2>Processed Movies</h2>
    <ul id="movieList"></ul>
    
    <h2>Download CSV Files</h2>
    <ul id="fileList"></ul>
    
    <script>
        document.getElementById("startProcess").addEventListener("click", function() {
            fetch("/start-process", { method: "POST" })
                .then(response => response.json())
                .then(data => alert(data.status))
                .catch(error => console.error("Error:", error));
        });

        function fetchProgress() {
            fetch("/progress")
                .then(response => response.json())
                .then(data => {
                    const movieList = document.getElementById("movieList");
                    movieList.innerHTML = "";
                    data.movies.forEach(movie => {
                        const li = document.createElement("li");
                        li.textContent = movie;
                        movieList.appendChild(li);
                    });
                });
        }

        function fetchFiles() {
            fetch("/files")
                .then(response => response.json())
                .then(data => {
                    const fileList = document.getElementById("fileList");
                    fileList.innerHTML = "";
                    data.files.forEach(file => {
                        const li = document.createElement("li");
                        const a = document.createElement("a");
                        a.href = `/download/${file}`;
                        a.textContent = file;
                        li.appendChild(a);
                        fileList.appendChild(li);
                    });
                });
        }

        fetchProgress();
        fetchFiles();
        setInterval(fetchProgress, 5000);
        setInterval(fetchFiles, 10000);
    </script>
</body>
</html>
